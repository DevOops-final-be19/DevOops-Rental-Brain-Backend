name: Code Review

# GitHub 저장소 읽기 및 PR 쓰기 권한을 설정
permissions:
  contents: read
  pull-requests: write

# PR 이벤트 관련해서 워크플로우 실행
on:
  pull_request:
    types: [opened]

# 워크플로우 실행 작업 정의
jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - name: ChatGPT codeReviewer
        uses: anc95/ChatGPT-CodeReview@main
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          OPENAI_API_KEY: ${{ secrets.OPENAI_API_KEY }}
          # optional
          MODEL: "gpt-4o"
          OPENAI_API_ENDPOINT: https://api.openai.com/v1
          LANGUAGE: ko
          PROMPT: |
            다음 PR을 Google/Meta 수준 코드 리뷰 기준으로 분석해주세요.

            반드시 다음 규칙을 따르세요:
            - 피드백 우선순위: P0(필수), P1(중요), P2(권장)
            - 문제뿐 아니라 해결책 제시
            - 구체 코드 예시 포함
            - 트랜잭션 경계, 예외 일관성, N+1, 동시성, 책임 분리, 중복 코드, 네이밍, SRP 관점 분석
            - 친절하고 협업 친화적 어조 + 이모지 필수
